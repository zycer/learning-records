第四章 第一章 基于贝叶斯时空图卷积的城市道路行驶时间预测模型

4.1 数据集构建

在本节中，我们同样采用了Kaggle提供的葡萄牙波尔图市从2018年6月到2018年9月某出租车运营公司的开放数据集。数据集包括1,710,666条真实出租车轨迹数据，共计83,409,193个轨迹点。交通拓扑由OpenStreetMap提供。为了解决城市道路行驶时间分布估计问题，我们首先进行了特征的选择与处理，然后构建了时空图。

4.1.1 特征选择与处理

我们首先对原始数据进行预处理，将轨迹数据与交通网络拓扑相匹配。我们采用了论文中的第三章提出的基于交互式投票的地图匹配方法（MIVMM），将数据集中的数据与OpenStreetMap提供的交通网络拓扑数据相匹配，并计算每条道路的平均行驶速度。经过分析，我们发现能够提取的有效特征包括道路长度、道路类型、限速和平均行驶速度等。在接下来的特征处理阶段，我们使用MinMaxScaler将道路特征即道路长度、道路类型以及限速进行归一化，其中道路类型先使用OneHot进行编码，使用StandardScaler对道路之间连接关系的特征即一条道路行驶到另一条道路的时间特征进行归一化，对这些特征进行归一化处理的目的是以消除量纲的影响。

4.1.2 行驶时间图的构建

为了充分考虑时空关系对道路行驶时间分布估计的影响，我们将上述数据集构建为时空图。首先，我们将所有数据分成了17000个时空图                                ，其中节点  表示道路，其特征分别为长度和限速；边特征为一条道路到另一条道路的行驶时间。每个时空图的时间间隔为1800秒，即30分钟。这种构建方式既能够体现道路之间的拓扑关系，又能够包含道路的时空动态变化，为模型提供了丰富的信息。

4.2 行驶时间分布估计模型

4.2.1 模型架构

4.2.2 贝叶斯深度图卷积

传统的图卷积网络（GCN）在许多图结构数据的任务上表现出色，例如节点分类、图分类和链接预测等，但在交通网络预测任务中，例如交通流量预测、拥堵预测和路线规划等，由于交通网络存在着不确定性，传统的图卷积网络（GCN）在预测不确定性方面存在以下问题：

\1.   实时交通情况的变化：交通网络的状态可能受到多种因素的影响，如天气、事故和道路维修等。这些因素可能导致实时交通状况的快速变化，使得预测结果具有很高的不确定性。传统GCN由于其参数确定性，无法直接量化这种不确定性，从而可能导致预测结果在面对实际变化时出现较大偏差。

\2.   多模态分布：在交通网络中，交通流量的分布可能呈现多模态特征。例如，早晚高峰期间的交通流量可能与非高峰期存在显著差异。传统的GCN由于其预测结果的单一性，无法捕捉到这些模态之间的潜在关系，从而在面对多模态分布的数据时表现不佳。

\3.   预测结果的泛化能力：交通网络中可能存在一些罕见的事件，例如道路关闭、突发事件等，这些事件会导致交通状况的不确定性增加。传统的GCN在面对这些未见过的事件时，可能会因为其模型不适应性而产生过于自信或过于保守的预测结果。这种不适应性可能导致模型在实际应用中的表现不佳，尤其是在处理具有高度不确定性的交通网络数据时。

传统GCN的这些缺点可能对模型的性能产生不良影响，为了解决这些问题，我们引入了基于贝叶斯方法的图神经网络（BayesianGCN）的自定义贝叶斯图卷积层，该卷积层可以更好地量化预测结果的不确定性，从而提高模型在面对交通网络中不确定性较高的情况时的泛化能力。该层基于贝叶斯神经网络的思想[54]，结合图卷积神经网络的理论[55]，以捕获节点特征的不确定性。

图卷积神经网络（GCN）通过在图结构上执行局部卷积操作来处理节点特征。GCN的基本操作定义为：

​                               

其中，  表示第$l$层的节点特征矩阵，  是输入图的邻接矩阵加上自连接，  是对应的度矩阵，  是第  层的权重矩阵，  是激活函数。为了捕获节点特征的不确定性，我们引入贝叶斯神经网络的思想，将权重矩阵  替换为随机变量  ，其中  是权重矩阵的后验分布。这使我们能够对每个权重参数进行概率建模，从而为节点特征提供更丰富的表示。

为了进行贝叶斯推断，我们采用变分推断方法[56]，用可微分的变分分布  近似真实后验分布  。我们将变分分布  选择为独立的正态分布：

 

其中，  和  是权重矩阵的均值和标准差参数，分别由神经网络学习。我们使用变分自动编码器（VAE）的重参数化技巧[57]来采样权重矩阵  ：

 

其中，  是从标准正态分布采样的噪声，  表示逐元素相乘，  是权重矩阵的标准差。

为了学习权重矩阵的后验分布参数  和  ，我们最小化变分下界（ELBO）的负值，即：

 

其中，  是观测数据的似然，  是权重矩阵的先验分布，通常选择为独立的正态分布。第一项是重构损失，度量了生成数据与观测数据之间的差异；第二项是KL散度，度量了变分分布与先验分布之间的差异。

综上所述，我们提出了一种基于贝叶斯神经网络的自定义深度图卷积层，该方法可以有效地捕获节点特征的不确定性，并提供更丰富的节点表示。通过变分推断方法，我们可以实现可扩展的贝叶斯推断，使得该方法适用于大规模图数据。

4.2.3 贝叶斯时空图变分自编码器模型

在本节中我们提出了一种名为贝叶斯时空变分自编码器模型BSTVAE，这是一个融合了贝叶斯理论、时空卷积网络（STGCN）以及变分自编码器VAE的深度学习模型。我们的方法旨在处理不确定性和融合时空信息，以提高预测性能。在本节中，我们将详细介绍贝叶斯自编码器的构建及其运作原理。

为了捕获交通数据的潜在表示，我们采用变分自编码器(VAE)架构。变分自编码器是一种生成性概率模型，它使用编码器和解码器两个神经网络来学习数据的潜在表示。通过最大化边界似然的下界来学习潜在变量的近似后验分布。假设输入数据为x，潜在变量为z。我们希望学习数据的概率分布P(x)，其中P(z)表示潜在变量的先验分布，在本文中，我们采用标准正态分布作为先验分布，P(x|z)表示给定潜在变量z时x的条件分布。由于直接计算后验分布P(z|x)是困难的，VAE引入了一个变分分布Q(z|x)来近似后验分布。我们的目标是最大化观测数据的边缘对数似然的下界（ELBO），即：

​                               

其中E_q[logP(x|z)]表示重构误差，即在潜在空间的采样z生成原始数据x的概率的期望，用于度量编码器和解码器的重构能力；D_KL(Q(z|x)||P(z))表示编码器输出的分布与先验分布之间的Kullback-Leibler散度，KL散度衡量了从编码器学习到的潜在分布Q(z|x)与先验分布P(z)的差异，用于度量潜在空间中的表示是否符合我们的先验知识。最优化ELBO会使得VAE学到的表示在重构和符合先验知识之间达到平衡。在我们的模型中，我们将编码器和解码器分别用神经网络实现，编码器网络将输入数据x映射到概率分布参数μ(x)和logvar(x)，解码器网络将潜在空间的采样z映射回数据空间x'，以最小化重构误差。具体而言，编码器和解码器可以表示为：

 

 

为了训练VAE，我们可以使用随机梯度下降（SGD）或其他优化算法最大化ELBO。在训练过程中，我们可以采用重参数化技巧（reparameterizationtrick）进行梯度传播，即通过引入一个独立于参数的噪声变量ε，将潜在变量z表示为：

 

其中  服从标准正态分布。

具体来说，BSTVAE模型包括以下组成部分：

1.时空图卷积网络（STGCN）：这部分包括了三层FeastConv，分别用于从输入特征中提取时空相关信息，每层STGCN后借一个Relu激活函数以增加非线性。

2.贝叶斯图卷积编码器，用于将输入特征映射到潜在空间的均值和方差；

3.重参数化操作，用于引入不确定性；

4.贝叶斯图卷积解码器，用于从潜在空间表示重建输入特征；

5.边缘行驶时间预测部分，用于预测关键指标。

接下来，我们逐一介绍BSTVAE的组成部分。

\1.   时空图卷积层（STGCN）

时空图卷积网络（STGCN）用于在图结构中捕捉交通网络中的时空依赖关系，包括时序关系以及局部邻居信息。在交通网络行驶时间预测的背景下，我们采用了一种名为FeaStConv的图卷积操作[58]，用于在图结构数据上捕获局部邻域信息。FeaStConv是一种特殊的图神经网络(GNN)操作，其基本思想是将每个节点的特征与其邻居的特征结合起来，以捕获局部结构信息。在交通网络中，FeaStConv可以提取道路网络中各个路段的时空特征。在BSTVAE模型中，我们使用了两层FeaStConv操作来学习输入特征的高级表示。通过堆叠多层FeaStConv，模型能够捕获更高层次的特征表示，有助于模型更好地理解复杂的交通网络模式。第一层FeaStConv的作用是将输入特征（例如，路段的车速、车流量等）映射到一个隐藏特征空间。在这一层中，模型学习到的特征表示主要反映了局部信息，如邻近路段之间的交通情况和相互关系。第二层FeaStConv的作用是在第一层FeaStConv提取的隐藏特征空间基础上，进一步提取更高层次的特征表示。在这一层中，模型能够捕获更广泛的上下文信息，例如在整个交通网络中的更远距离的路段之间的交通情况和相互关系。这有助于模型在预测行驶时间时考虑到更多的时空信息。通过这两层FeaStConv的堆叠，BSTVAE模型可以捕获交通网络中的时空特征，并将这些特征与贝叶斯图卷积编码器、解码器以及边缘行驶时间预测部分相结合，实现对行驶时间的准确预测。

具体来说，首先对于节点  ，我们表示其邻居集合为  ，其中  表示节点  是节点  的邻居。其次计算节点  的聚合信息  ，由节点$i$的特征  以及其邻居  的特征  组成：

 

其中，  表示第  层节点  的特征向量，  表示节点  的邻接节点集合，  是节点  和  之间的归一化权重，  是第  层的权重矩阵，  是激活函数（如ReLU）。最后，我们将节点$i$的原始特征  与新的节点特征  结合起来，得到最终的节点特征表示：

 

FeaStConv的优点在于其具有良好的局部感知能力，在交通网络图中能够捕捉节点之间的空间相关性以及其随时间的动态变化。

\2.   编码器

在BSTVAE模型中，编码器部分是基于贝叶斯图卷积的神经网络，其目的是将输入的时空特征映射到一个潜在空间，从而捕获交通网络中的不确定性信息。编码器包括两个上一节中提出的贝叶斯图卷积层（BayesianGCNConv），贝叶斯图卷积是一种基于图卷积神经网络（GCN）的扩展，它可以在捕获图结构特征的同时，学习到不确定性信息[59]。对于编码器中的第一层贝叶斯图卷积（BayesianGCNConv），其作用是将输入特征（FeaStConv的输出）映射到一个隐藏特征空间。给定一个图G=(V,E)，其中V是节点集合，E是边集合。对于每个节点i，其输入特征为x_i，我们可以表示第一层贝叶斯图卷积的操作为：

 

其中，  表示节点  的邻居节点集合，  和  分别是该层的权重矩阵和偏置项，ReLU为激活函数。第二层贝叶斯图卷积的作用是将隐藏特征空间映射到一个潜在空间。这个潜在空间的维度是2倍的_latent_size，这是因为我们需要从这个空间中分离出均值（μ）和对数方差（logσ^2）。第二层贝叶斯图卷积的操作可以表示为：

 

其中，  和  分别是第二层的权重矩阵和偏置项。通过这两层贝叶斯图卷积，BSTVAE模型将输入特征映射到潜在空间，并为每个节点学习到均值（  ）和对数方差（  ）。这些参数可以用于衡量交通网络中的不确定性信息，从而提高行驶时间预测的准确性。

\3.   重新参数化

重参数化操作是变分自编码器（VAE）的关键组成部分，用于将潜在变量的分布参数化为神经网络的输出。这一操作使得我们能够在保留梯度传播的同时采样潜在变量，从而实现端到端的模型训练[60]。在编码器部分，我们学到了每个节点的均值（  ）和对数方差（  ），然后将这些参数作为重参数化操作的输入。重参数化操作可以表示为：

 

其中，  表示节点i的潜在变量，  和  分别表示节点i的均值和标准差（  ），  表示元素间乘法。  是一个独立的噪声项，通常采样自标准正态分布：  。

重参数化操作的关键优势在于，它将随机噪声与确定性的神经网络输出分离，这使得我们可以在保留随机性的同时进行梯度传播。这对于训练VAE模型至关重要，因为它允许我们通过反向传播算法来优化模型参数，从而实现端到端的训练。在BSTVAE中，重参数化操作使得我们能够在训练过程中有效地学习交通网络中的不确定性信息，从而提高行驶时间预测的准确性。

\4.   解码器

解码器部分负责从学到的潜在变量z恢复出原始输入特征x。解码器采用贝叶斯图卷积神经网络（Bayesian GCN）来实现，将潜在变量映射回原始特征空间。解码器包含两层贝叶斯GCN层。首先，我们使用第一层贝叶斯GCN操作将潜在变量z映射到一个中间表示  ，并应用ReLU激活函数：

 

其中，BayesianGCNConv1表示第一层贝叶斯图卷积操作。z是重参数化后的潜在变量，edge_index和edge_weight分别表示图结构和边权重。接下来，我们使用第二层贝叶斯GCN操作将中间表示z^(1)映射回原始特征空间，得到重构的节点特征x_hat，并应用tanh激活函数：

 

其中，BayesianGCNConv2表示第二层贝叶斯图卷积操作。解码器的目标是最小化重构误差，即原始输入特征x与重构特征x_hat之间的差异。通常情况下，我们使用均方误差（MSE）损失来衡量这一差异：

 

在BSTVAE模型中，解码器的作用是重建交通网络的节点特征，并通过学习潜在空间的结构，捕捉交通网络中的时空依赖关系。这使得模型能够有效地预测交通网络中的行驶时间。

在BSTVAE模型中，边缘行驶时间预测部分是一个重要组成部分，它利用从节点特征中提取的信息来预测交通网络中的行驶时间。具体来说，模型通过计算边缘的两个相邻节点的特征差值来获取边缘特征。然后，这些边缘特征被输入到一个线性层，以预测交通网络中各边缘的行驶时间。首先，从节点特征x中计算边缘特征：

 

其中，x_i和x_j分别表示边缘连接的两个节点的特征。接下来，将计算得到的边缘特征edge_features输入到一个线性层中，得到预测的行驶时间t_hat：

 

其中，Linear表示线性层。t_{hat}表示预测的行驶时间。边缘行驶时间预测部分的目标是最小化预测行驶时间t_hat与真实行驶时间t之间的差异。通常情况下，我们使用均方误差（MSE）损失来衡量这一差异：

 

在BSTVAE模型中，边缘行驶时间预测部分的作用是学习交通网络中的时空依赖关系，并利用这些关系预测行驶时间。这使得模型能够有效地应用于交通网络行驶时间预测任务。

4.2.4 对抗网络的生成

在我们提出的基于生成对抗网络（GANs）的交通网络行驶时间估计模型中，生成器（G）采用了BSTVAE模型，而判别器（D）采用了图注意力网络（GAT）结构。

\1.   生成器（G）：

生成器G使用BSTVAE作为基本结构。BSTVAE包括时空图卷积网络（STGCN），贝叶斯图卷积编码器，重参数化操作，贝叶斯图卷积解码器以及边缘行驶时间预测部分。生成器G接收交通网络中节点的特征x作为输入，输出预测的行驶时间t_hat。BSTVAE的详细介绍已经在之前的回答中给出。

\2.   判别器（D）：

判别器D采用图注意力网络（GAT）作为基本结构。GAT可以有效地捕获节点之间的复杂依赖关系，提高模型在交通网络行驶时间预测任务中的性能。判别器D包括两个GAT层和一个全连接层。判别器的输入是节点特征x和边特征（edge_index和edge_weight），输出是判别器对输入样本的判断结果，即样本为真实数据的概率p_real。

判别器D的结构可以表示为：

​                               

其中，  表示判别器的参数。在交通网络行驶时间预测任务中， 在本研究中，我们将生成器（G）和判别器（D）进行交替训练，通过最小化生成器生成的数据与真实数据之间的差异来优化生成器。GANs的训练目标函数可以表示为：

 

其中，E表示期望值，x表示真实数据，z表示随机噪声，G(z)表示生成器生成的数据。

在训练过程中，判别器D试图最大化对真实数据和生成数据的分类正确率，而生成器G试图最小化判别器对生成数据的分类误差。通过这种相互竞争的训练过程，生成器和判别器将不断提高，最终使生成器生成的数据分布趋近于真实数据分布。

具体地，在每个训练迭代中，我们首先固定生成器G，优化判别器D。这一过程可以通过最大化V(D, G)实现。然后，我们固定判别器D，优化生成器G。这一过程可以通过最小化V(D, G)实现。通过反复进行这两个步骤，我们可以训练出一个有效的生成对抗网络。

在交通网络行驶时间预测中，采用GANs具有以下优点：

（1）      模型可以通过捕获真实数据的复杂结构生成高质量的行驶时间预测。

（2）      GANs具有很强的表示能力，可以更好地捕获数据中的不确定性和复杂性。

（3）      生成器和判别器之间的竞争有助于模型在预测任务中更好地泛化。

（4）      GANs可以自适应地学习数据的潜在结构，而无需对特定问题进行显式建模。

综上所述，我们提出了一种基于生成对抗网络的交通网络行驶时间估计模型，其中BSTVAE作为生成器，GAT作为判别器。通过将BSTVAE和GAT结合，我们的模型可以有效地捕获交通网络中的时空特征和节点间复杂依赖关系。此外，采用GANs训练方法可以进一步提高模型的预测性能。我们相信这一模型在交通网络行驶时间预测任务中具有广泛的应用潜力。

4.3 实验与评估

在本章中，我们将详细介绍基于贝叶斯图卷积神经网络的城市道路行驶时间预测模型的实验与评估。为了验证所提出模型的有效性和性能，我们设计了一系列实验，以及与其他模型的对比分析。为了全面评估模型性能，我们进行了多方面的评估和对比分析。首先，我们计算了所提出模型与其他模型在累积分布函数（CDF）上的对比；其次，我们计算了每天与每周的Kullback-Leibler散度对比，以评估模型对于不同时间尺度上的道路行驶时间分布估计的适应性；最后，我们计算了平均绝对误差（MAE）、均方根误差（RMSE）、平均绝对百分比误差（MAPE）以及均方误差（MSE）等指标，用于量化模型的预测精度。通过这些实验评估，我们将展示所提出的基于贝叶斯图卷积神经网络的城市道路行驶时间预测模型在不同方面的性能，并与其他模型进行对比，从而验证所提出模型的有效性和优越性。此外，我们还将对实验结果进行深入分析，以进一步挖掘模型在处理城市道路行驶时间预测问题时的优势和潜在不足。

4.3.2 结果对比与分析

在本节中，我们将首先介绍累积分布函数（CDF）图像和真实道路行驶时间与预测行驶时间的图像，以便直观地展示基于贝叶斯图卷积神经网络（BST-GCN TTDE）的城市道路行驶时间预测模型的性能。

在CDF图像中，蓝色线表示真实行驶时间分布，黄色线以及其他颜色线分别表示BSTGCN TTDE模型以及其他参与对比模型的预测行驶时间分布，从图像上可以看出，黄色线相较于其他颜色的线更靠近蓝色线，说明我们的模型能够很好地捕捉到真实行驶时间的分布特性，这表明BSTGCN TTDE模型在整体预测性能上表现出色。

在真实道路行驶时间与预测行驶时间图像中，我们展示了若干个道路的真实行驶时间与预测行驶时间的折线图。从图像中可以观察到，预测行驶时间与真实行驶时间之间存在相同的趋势，并且几乎一致。这进一步说明了BSTGCN TTDE模型在具体道路上的行驶时间预测方面具有较高的准确性。CDF图像和真实道路行驶时间与预测行驶时间图像均表明BSTGCN TTDE模型在城市道路行驶时间预测方面具有较高的整体准确性和可靠性。接下来我们将继续深入分析模型在不同评估指标和应用场景下的表现，以全面评价BSTGCN TTDE模型的性能。

为了更好地说明对于一天中与一周中的模型性能，图给出了GSTGCN TTDE的KL散度与其他四种关于道路行驶时间预测的基线方法。该图表明，我们提出的GSTGCN TTDE在所有研究时间段的表现都优于基线。在每天KL散度对比图像中可以看到，共有五个模型进行对比，分别为MGMM、BiSN、LSH、DeepTTDE以及我们提出的BSTGCN TTDE。图像显示，MGMM的KL散度在1.2左右波动，BiSN和LSH的KL散度在1.0左右波动，DeepTTDE的KL散度在0.8左右波动，而我们的BST-GCN TTDE模型在0.6左右波动。这表明BST-GCN TTDE模型在每天的道路行驶时间分布估计方面具有更低的误差。在每周的时间尺度上，在KL散度对比图像中我们同样对比了五个模型的KL散度表现。与每天KL散度对比图像类似，BSTGCN TTDE模型在每周道路行驶时间分布估计中仍然表现出较低的误差。这说明BSTGCN TTDE模型在不同时间尺度上均具有较高的适应性和稳定性。

通过对每天和每周KL散度的对比分析，我们可以得出结论：BST-GCN TTDE模型在道路行驶时间分布估计方面具有显著优势，相较于其他四个模型，BST-GCN TTDE在不同时间尺度上都表现出较低的误差。虽然本文中所用到的数据集与其他基线方法使用的数据集可能不同，但所有方法都显示出一周内每天的周期性模式，这符合道路连接线的拥堵状况通常也是周期性的基本事实， 这一结果进一步证实了BSTGCN TTDE模型在城市道路行驶时间预测方面的高准确性和可靠性。

接下来我们计算了BSTGCN TTDE模型在测试集上的MAE与RMSE，以进一步评估模型在实际应用中的性能。MAE和RMSE是两种常用的误差度量方法，分别用于衡量模型预测结果与真实值之间的差异。MAE表示预测误差的平均绝对值，用于评估模型预测的准确性。RMSE表示预测误差的平方和的平均值的平方根，主要用于评估模型预测的稳定性。衡量MAE和RMSE的目的是为了从不同角度评估模型在实际应用中的性能。图像展示了在100条随机选取的道路上，模型预测行驶时间的平均绝对误差（MAE）与均方根误差（RMSE）的折线图，从图中可以看出两条折线具有相同的趋势，值域在0.0001到0.0018之间波动。从图像中可以看出，BST-GCN TTDE模型在这100条道路上的MAE和RMSE值均在较低的范围内波动，且具有相同的趋势。这说明模型在预测城市道路行驶时间方面表现出了较高的准确性和稳定性。结合前面的CDF、KL散度等评估指标，我们可以进一步确认BST-GCN TTDE模型在城市道路行驶时间预测方面具有较高的性能和可靠性。

通过分析模型在同样的100条随机选取的道路上的平均百分比误差（MAPE）和均方误差（MSE）指标。根据图像，我们可以观察到MAPE值在0.02至1之间波动，而MSE则在0.2至3之间波动。MAPE是衡量预测误差与真实值的相对大小的度量，能够反映预测偏差在整个数据集中的占比。在城市道路行驶时间预测任务中，MAPE有助于我们评估模型在不同规模的道路上的预测能力。而MSE则是衡量预测误差平方的均值，能够突显较大的误差。在实际应用中，MSE有助于我们识别模型在某些特定情况下可能存在的较大预测偏差。结合之前提到的MAE与RMSE一起的图像，我们可以更全面地了解BSTGCN TTDE模型在预测城市道路行驶时间方面的性能。从MAPE和MSE的值域来看，模型在这100条道路上的预测误差相对较低，表现出了较高的准确性。通过综合考虑MAE、RMSE、MAPE和MSE这四个评估指标，我们可以得出结论：基于贝叶斯图卷积神经网络（BSTGCN TTDE）的城市道路行驶时间预测模型在实际应用中表现出了较高的准确性、稳定性和泛化能力，为解决城市交通管理问题提供了有力支持。

4.3.3 影响因素分析

在上一节中我们分析了基于贝叶斯图卷积神经网络（BSTGCN TTDE）的城市道路行驶时间预测模型的性能。为了更深入地了解影响道路行驶时间预测的因素，我们结合实验内容以及交通道路网行驶时间预测问题背景，将影响因素可以归纳为两大类：一是与城市交通网络和道路属性相关的因素，二是与模型结构和超参数相关的因素。

一、城市交通网络和道路属性相关因素

交通网络拓扑结构：城市道路网络的拓扑结构对行驶时间预测具有重要影响。复杂的道路网络结构可能导致交通流的传播更具挑战性。因此，理解和建模道路网络的拓扑关系对于预测行驶时间至关重要[61]。

时空特征：交通流在时空上具有显著的周期性和趋势性[62]。因此，在建立预测模型时，需要充分考虑时空特征的影响。本研究中，我们将交通数据构建为时空图，以捕捉道路之间的时空关系。

道路属性：不同类型的道路具有不同的属性（如道路长度、类型、限速等），这些属性对行驶时间具有显著影响[63]。本研究中，我们对这些属性进行了处理，并将其作为模型的输入特征。

实时交通状况：实时交通状况对行驶时间预测具有显著影响，如道路拥堵、突发事件等[64]。因此，实时交通信息的获取和融合对于提高行驶时间预测的准确性至关重要。

二、模型结构和超参数相关因素

图卷积层数（Number of Graph Convolution Layers）：图卷积层数决定了模型学习到的局部邻域的范围。增加图卷积层数可以使模型学习到更广泛的邻域信息，但同时可能增加模型的复杂度和过拟合风险。因此，在实验中需要权衡图卷积层数以达到较好的性能。

学习率（Learning Rate）、批次大小（Batch Size）、隐藏层神经元数量（Number of Hidden Units）以及正则化系数（Regularization Coefficient）等超参数对模型的性能具有关键影响。在实验过程中，需要通过交叉验证或网格搜索等方法来调整这些超参数，以达到模型的最佳性能。这些方法可以帮助我们找到一组能够在训练集上获得较低误差的同时，在验证集上保持较好泛化性能的超参数组合。

交叉验证：在实验过程中，我们可以将训练数据集划分为k个子集，每次将其中一个子集作为验证集，其余子集作为训练集。通过这种方式，我们可以对不同的超参数组合进行多次训练和验证，从而更准确地评估不同超参数组合对模型性能的影响。

网格搜索：网格搜索是一种通过遍历预定义的超参数值范围来寻找最佳超参数组合的方法。对于每种可能的超参数组合，我们可以使用交叉验证来评估其性能。然后，我们可以选择在验证集上表现最佳的超参数组合作为最终模型的超参数。

需要注意的是，调整超参数时要避免在训练过程中过度依赖验证集，以免引入过拟合的问题。此外，在实际应用中，我们可能需要权衡模型性能和计算资源之间的关系，以便在有限的计算资源下实现较好的预测性能。

综合以上分析，我们认为影响基于贝叶斯图卷积神经网络（BST-GCN TTDE）的城市道路行驶时间预测模型的因素主要包括城市交通网络和道路属性相关因素以及模型结构和超参数相关因素。通过深入理解这些影响因素，并在实验过程中合理地调整模型结构和超参数，我们可以进一步优化BST-GCN TTDE模型，以在实际应用中实现更高的预测准确性。

4.3.4 本章小结

在本章中，我们详细介绍了基于贝叶斯图卷积神经网络（BSTGCN TTDE）的城市道路行驶时间预测模型的实验设置、实验结果与分析以及影响因素分析。首先，我们设计了一系列实验，通过多种评价指标对BST-GCN TTDE模型及其他对比模型进行了全面评估。实验结果表明，BST-GCN TTDE模型在行驶时间预测任务上优于其他模型，显示出较好的性能和泛化能力。接着，我们深入分析了影响道路行驶时间预测的各种因素，包括交通网络拓扑结构、时空特征、道路属性等。我们还讨论了实时交通状况数据的融合对预测准确性的重要性。此外，我们分析了模型结构（如图卷积层数）和超参数（如学习率、批次大小、隐藏层神经元数量和正则化系数）对实验结果的影响，并强调了调整超参数对于模型性能优化的重要性。本章的分析为进一步优化城市道路行驶时间预测模型提供了理论依据和实践指导。通过合理地调整模型结构和超参数，以及充分考虑交通网络的特点和实时数据，我们有望实现更高的预测准确性，从而为智能交通系统和城市规划提供更有价值的参考信息。
