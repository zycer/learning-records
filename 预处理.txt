在获取OSM文件后系统会根据区域位置请求对应区域的开放交通数据API接口，筛选出对应区域的GPS历史轨迹数据，图 5.6为下载的GPS轨迹数据，数据包含对应道路的id以及若干轨迹点，这些数据作为原始输入，为后续的数据预处理和分析提供基础。

数据预处理：在这一部分，对获取到的GPS轨迹数据和OSM文件进行处理，以便更好地应用于地图匹配和模型训练与预测。数据预处理包括以下几个步骤：
a)	GPS轨迹去噪：对于车辆停止时产生的轨迹数据以及两个连续轨迹点位置相差过大的点进行删除，从而减少噪声对模型训练与预测的影响。
b) OSM文件解析：读取OSM文件中的node标签与way标签，将OSM数据解析成路网图结构，并将解析后的路网图进行简化，即对于同一路口的多个节点合并为同一个节点，图 5.7为处理后的道路数据，其中每一条数据作为路网图结构中的一条边，每一条道路有name、hightway、length以及maxspeed等多个特征，图 5.8为处理后的到路口数据，每一条数据作为路网结构中的一个节点，由于节点只表示道路的连接性，所以节点除了位置信息无其他特征。这一步骤为后续的地图匹配和模型训练与预测提供了基本的地理信息。
c) 图反转：将解析出的路网图进行反转，即将原来的道路表示为边，路口表示为节点的图结构反转为道路表示为节点，道路之间的连接关系表示为边。这样能够更好地适应基于贝叶斯时空图自编码器的模型学习与特征表示。图 5.9为反转后的边数据。



数据预处理
数据预处理分为GPS轨迹去噪、OSM文件解析以及图反转。
1. GPS轨迹去噪
对于车辆停止时产生的轨迹数据以及两个连续轨迹点位置相差过大的点进行删除，然后使用卡尔曼滤波法GPS数据中偏差较大的数据点进行纠正，从而减少噪声对模型训练与预测的影响。
2. OSM文件解析
读取OSM文件中的node标签与way标签，将OSM数据解析成路网图结构，并将解析后的路网图进行简化，即对于同一路口的多个节点合并为同一个节点，道路数据中每一条道路有name、hightway、length以及maxspeed等多个特征，路口数据中，每一条数据作为路网结构中的一个节点，由于节点只表示道路的连接性，所以节点除了位置信息无其他特征。这一步骤为后续的地图匹配和模型训练与预测提供了基本的地理信息。
3. 图反转
将解析出的路网图进行反转，即将原来的道路表示为边，路口表示为节点的图结构反转为道路表示为节点，道路之间的连接关系表示为边。这样能够更好地适应基于贝叶斯时空图自编码器的模型学习与特征表示。
