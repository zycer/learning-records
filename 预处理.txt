数据预处理
为了使基于贝叶斯时空图自编码器的道路行驶时间预测模型更准确地学习与预测，需要对原始数据进行一系列预处理。本节将对数据预处理的三个步骤进行详细描述：GPS轨迹去噪、OSM文件解析以及图反转。
GPS轨迹去噪  
由于GPS信号容易受到建筑物、天气等环境影响，会产生一定量的噪声，影响位置精度。为减少噪声对模型的影响，本文对车辆停止期间记录的轨迹数据以及两个连续GPS点的位置偏差过大的数据点进行删除。对于仍存在较大误差的GPS数据点采用卡尔曼滤波法对其进行校正。
卡尔曼滤波法是一种递归的线性最小二乘问题，通过状态方程和观测方程迭代求解当前时刻的状态估计值。状态方程表达系统动态模型，观测方程表达观测值与状态变量之间的关系。状态方程为:  
█(x_k= Ax_{k-1} + Bu_k+ w_k#(4.1) )
观测方程为:
█(z_k= Hx_k+ v_k#(4.2) )
其中，$x_k$ 为状态变量,$u_k$ 为控制变量，$w_k$ 为过程噪声，$z_k$ 为观测变量，$v_k$ 为观测噪声。通过反复求解上述方程,我们可以获得当前时刻更加准确的状态估计值。该方法能有效利用历史信息对当前信息进行校正,从而得到更加精确的结果。
OSM文件解析  
OSM文件记录了选定范围内的所有道路、交叉路口、节点、地理区域以及元数据等信息，由于本文只关注路网结构，因此只关注与道路相关的node标签和way标签。表4-1为OSM文件中node标签的部分数据示例，数据包括node唯一标识、修改版本、经纬度以及更新时间戳等信息，表4-2为OSM文件中way标签的部分数据示例，数据包括way唯一标识、修改版本、更新时间戳路名以及形状等信息。本文将OSM数据解析成路网图结构G(V,E)，其中V为节点的集合，表示路网中的路口，E为边集合，表示路网中的道路，每条道路有name、highway、length、lanes以及maxspeed等特征，节点除经纬度位置信息外无其他特征，表4-3为图G中边数据的部分示例，数据中包含边的起点终点、车道数、道路名称、道路长度以及道路形状等信息，表4-4为图G中节点数据的部分示例，数据中包含节点对应OSM文件中的id以及经纬度信息。在获得路网图G后再其进行简化，将同一路口的多个节点合并为同一个节点，这大幅度的简化了路网，减少了路网相关计算的时间。该步骤为后续的地图匹配和模型训练与预测提供基本地理信息。
图反转
为更好地适应基于贝叶斯时空图自编码器的学习与表示，本文将上一节中得到的路网图G(V,E)进行反转，即将原有的以道路为边、路口为节点的图结构反转为以道路为节点、道路之间连接关系为边的图结构G’(V,E)。表4-5为反转后图G’边数据的部分示例，数据中包含边的起点终点（与表4-2中road id对应）以及对应节点id。反转后的图结构可以使模型更好地学习道路特征并利用道路之间的时空关联进行推理。换言之，G’更符合模型的学习机制，有助于模型学习交通网络的时空依赖关系。
