# 摘要
路段行程时间估计在智能交通运营管理中起着至关重要的作用。由于交通的不稳定带来的不确定性，旅行时间估计用概率分布比确定性模型更好地描述。现有的旅行时间分布估计方法大多基于预定义的概率分布。其他方法虽然放松了约束，但不能利用拓扑信息，而且数据效率低。本文提出了一种新的基于贝叶斯和几何深度学习的方法，用于基于车辆GPS轨迹估计城市交通网络中道路链路的行程时间分布。特别地，首先对历史轨迹或实时轨迹进行预处理，构建部分走时图，并将其输入到定制的贝叶斯图自动编码器中，重建多个完整的走时图。此外，我们还采用了一个辅助神经网络来促进所提方法的参数训练，遵循对抗性训练的原则。为了评价所提出的方法，我们在一系列综合案例研究中使用了一个真实世界的车辆轨迹数据集。实验结果表明，所提出的方法优于目前最优的基线，约10%的Kullback-Leibler散度减少。
# 1. 引言
智能交通系统(ITS)是智能城市的重要组成部分[1]。智能交通作为现代经济中的基础性和战略性产业，以缓解交通拥堵、减少化石燃料消耗、提高运输效率为目标，引起了业界和研究界的广泛关注[2]、[3]。在ITS中，行程时间估计在支持交通监控和车辆路径选择等高级ITS服务方面起着至关重要的作用[4]。更好的估计会改善这些服务的性能，进而导致交通用户的更好体验，包括但不限于车辆和通勤者[5]-[7]。

现有的工业解决方案和研究工作大多是基于历史数据准确地提供交通网络中道路链路的行程时间[8]。然而，准确的路段行程时间受到许多难以记录的因素的影响，如车辆状况和驾驶方式[9]。结果，这些不确定性可能阻碍这些去终止旅行时间估计器产生可靠的估计[4]，[8]。针对这一问题，学术界对所谓的行程时间分布估计(TTDE)的研究日益关注，它假定路段行程时间是由交通的异质性和动态性驱动的时变随机变量[10]、[11]。Pioneer的TTDE工作通常假设旅行时间服从高斯或对数正态分布，并开发了经验结果来讨论它们各自的适用性[12]，[13]。然而，这些参数模型虽然易于理论分析，但不能提供足够的表达来表示旅行时间动力学[9]，[14]。这种关注导致了目前在没有高斯假设的情况下对TTDE的最先进的研究。

一般说来，在没有预先假设的情况下，有两种主流的旅行时间分布方法。最近，Prokhorchuk等人。文[4]提出用高斯copula图形lasso模型将旅行时间的非高斯特性转化为高斯特性。其主要原理是利用copula模型中的协方差矩阵来挖掘相邻路段之间行程时间的统计相关性。由于它的参数性质，所提出的方法可以利用低分辨率和稀疏的GPS轨迹估计时间分布，而不依赖于以前常见的假设，如高斯性和链路无关性。随后，段等人。更进一步，设计了一个基于核密度估计的TTDE模型[8]。采用这种非参数概率密度估计方法，可以很好地捕捉随道路条件变化的时变行程时间动力学。

然而，在TTDE问题上存在研究空白。现有的TTDE方法主要使用稀疏的车辆轨迹[4]或有限的交通检测器[8]来估计分布。一方面，这些方法可以应用到实际的交通网络中，在低数量和/或低质量的交通数据支持下，扩大了其适用性。另一方面，当处理大量的组织车辆痕迹时，要么必须采用数据下采样[4]，要么可能会经历很高的计算负担[8]，这是广泛预期的，也是当代众包技术非常合理的。因此，就产生了数据利用不足的问题。目前已有相关的路线行程时间预测方法，旨在提供城市区域内两个地点之间任意路线的时间估计。然而，这些方法都不能满足TTDE的要求，因为后者更好地用于实时生成最优路线，而前者更多地用于行程分析和离线路线推断[15]。研究差距倡导学术界和工业界为TTDE设计新的解决方案。

数据高效的TTDE方法的前景使深度学习成为一个引人注目的解决方案，它利用多层感知器从原始数据中挖掘潜在的特征[16]。为了弥补这一研究空白，本文基于深度学习技术的最新发展，提出了一种新的城市域TTDE方法。我们特别考虑了存在于原始的、历史的和实时的车辆GPS轨迹中的不确定性，并使用贝叶斯深度学习[17]的原理来从中学习。此外，我们采用图卷积概念[18]进行非欧几里得空间特征提取，它比基于标准张量的数据分析[7]更好地描述了交通网络。该模型是利用数据挖掘和机器学习研究中的深度神经网络构建块建立的，为TTDE提供了一种新的解决方案，并为未来TTDE模型的发展提供了见解。这项工作的主要努力概述如下：
● 提出了一种基于深度学习技术的TTDE方法。采用贝叶斯和几何深度学习的设计原理来构造新的深度神经网络。
● 为了提高该方法的训练性能，我们采用了一种对抗性训练方法，并设计了该方法的训练方案和在线推理方案。
● 我们在一个具有十亿多个GPS记录的真实世界数据集上验证了所提方法的有效性。实证结果证明了该方法的重要性和敏感性。

据我们所知，这是利用深度学习估计道路路段行程时间分布的开创性工作之一。该方法不仅适用于TTDE，而且可以进一步适用于智能交通系统中的各种概率估计问题。

本文的其余部分组织如下。第2节简要概述了相关工作，并对TTDE问题进行了阐述。第三节详细介绍了基于深度学习的TTDE方法，并对其训练和推理进行了详细的介绍。第4节介绍了一个真实世界数据集的案例研究，以证明该方法的有效性。最后，在第五节对本文工作进行了总结。
# 2. 初步工作
## 2.1 相关工作
旅行时间估计是文献[4]中研究较多的一个研究课题，是时空数据挖掘[19]的一个应用。相关研究一般可分为两大类，即确定性行程时间估计，其目的是估计道路链路的平均行程时间，而TTDE则提供了行程时间的估计概率分布。随着big 2数据时代的出现，这两个问题现在都明显依赖于历史旅行时间数据的可用性[20]。提出了多种基于数据挖掘的方法来开发均值估计，包括但不限于线性回归[21]、支持向量回归[22]、人工神经网络[23]、隐马尔可夫模型[24]等。我们请读者参阅[4]、[7]以获得确定性旅行时间估计文献的详细概述。

随着确定性估计问题的出现，TTDE在过去几年中受到了越来越多的关注[8]。在高斯或对数正常旅行时间的假设下进行了一系列研究。文献[12]和[13]分析了高斯分布和对数正态分布在交通流条件和空间相关性下的旅行时间建模中的适用性。参考文献[25]进一步研究了替代概率分布作为基本参数模型。文献[26]使用高斯混合模型推导了旅行时间。文献[4]，[27]，[28]分别将高斯copula与图形套索、贝叶斯推断和截面溢出分析相结合，用于TTDE。参考文献[29]采用移动平均方法来估计威慑旅行时间，并采用分布估计算法来提供先前估计的置信区间。另一方面，放宽高斯假设的尝试导致了基于广泛学习技术的TTDE方法。例如，文献[30]设计了一种基于马尔可夫链的启发式算法来计算主干道连接的行程时间分布。文献[31]提出了一种基于始发目的地对的Bayesian网络的TTDE算法，并利用期望最大化算法解决路径不确定性问题。参考文献[20]提出了一种基于深度学习的生成对抗网络，考虑出行信息最大化来估计短途和长途出行的分布。文献[32]提出了一个深度生成模型来估计包含多个道路连接的路线的行程时间分布，该模型比旅行前规划更适合于旅行后分析和路线恢复[15]。文献[33]采用了一种编码器-解码器深度神经网络，利用道路起伏、交通周期和路线轨迹的嵌入来估计行程时间。该模型的目标是提供确定性的旅行时间估计路线比道路连接，这仍然不是一个确切的匹配TTDE。

综上所述，人们提出了许多方法来正确估计旅行时间分布。然而，较少的研究集中于从数据不确定性中建模和学习，这是重要的，包括在此背景下的认知（系统）和自适应（mea-surement）的不确定性。此外，交通网络所调节的空间数据相关性没有被考虑在内，从而可能导致性能下降。为了解决这些问题，本文提出了一种新的基于深度学习的TTDE方法。
## 2.2 行程时间分布估计
利用稀疏实时GPS数据估计城市交通网络中道路链路的行程时间分布。将交通网络建模为一个有向图,其中V是路段（路段）的集合，E表示路段在V中的连通性，即：如果车辆可以从vi∈V直接穿越到vj∈V,则为(vi,vj)∈E。1给出了这种图表示的一个说明性例子，它不同于通常的道路网络中交叉口由图节点表示的图表示，在利用链接相关性时更具有表现力[34]。TTDE的目标是在给定普遍存在和稀疏的实时GPS轨迹的情况下，获得所有链路v∈v在时隙t长度为θ时的行程时间分布Prv，t(t)。路径行程时间分布可以通过累加构成链路的行程时间分布得到[4]。

TTDE的主要挑战是三重的，每一个都引起了数据挖掘领域的研究兴趣，但没有得到充分的集体解决，尤其是TTDE。首先，GPS轨迹中的认知和任意不确定性使得任何发现潜在旅程时间干扰的数据挖掘策略都具有挑战性。一般的数据驱动方法可能会受到干扰，取而代之的是学习噪声模式，从而产生较差的估计。开发一个量身定制的估计器来充分利用存在不确定性的大量历史数据是一项具有挑战性的任务。其次，连接链路的行程时间变化是高度相关的，因此估计者需要利用链路的行程时间如何依赖于其他[4]，[7]。在交通网络中，这种相关性主要由邻接矩阵捕获。由于计算EF-FORT致力于探索结构或空间数据之间的关系，因此不使用这种拓扑信息可能会导致性能下降。第三，TTDE将旅行时间视为随机变量，并产生它们的估计，这与研究得很好的确定性旅行时间估计不同，后者发展了定点估计[8]。如何推断出准确可靠的概率分布仍然是数据挖掘和表示学习界的一个悬而未决的问题。事实上，没有合作应对这些挑战的解决办法，早先在其他问题上的努力也不能轻易地转移到TTDE上。考虑到这些挑战，我们利用多个构建块和深度学习的设计概念为TTDE提供了一个解决方案。
