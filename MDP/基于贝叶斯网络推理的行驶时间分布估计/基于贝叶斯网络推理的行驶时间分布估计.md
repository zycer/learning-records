基于贝叶斯网络推理的行驶时间分布估计
---------------

# 摘要
行驶时间估计是智能交通系统（ITS）的一个重要方面。在城市环境中，由于各种随机因素，行驶时间可能会出现很大的变化。因此，我们专注于估计行驶时间分布，**与大部分研究的平均预期行驶时间估计形成鲜明对比**。我们提出了从浮动汽车数据中推断行驶时间分布的算法，特别是从稀疏的GPS测量中推断行驶时间分布。该框架结合了**高斯耦合**和**网络推理**，以估计行驶时间的**边缘和联合分布**。我们对一个月的GPS轨迹进行了一系列广泛的数值实验。我们根据50个最常见的轨迹的Kullback-Leibler (KL)发散和海林格距离对所提出的模型进行了基准测试。与基线方法相比，结合高斯Coulas和贝叶斯推理的稀疏网络方法，KL发散减少4.9%，海林格距离减少2%。

# 1. 引言
智能交通系统（ITS）旨在减少交通拥堵，降低油耗，并改善交通的其他方面。行驶时间信息在不同的ITS应用中起着至关重要的作用，如随机路由[1]、拼车[2]和交通监控[3]。更好地估计行驶时间可以提高此类系统的总体性能，为用户提供更准确的信息，包括更好的路线选择和交通选择[4]。ITS用户的另一个关键方面是行驶时间的变化，这会影响上述所有示例。然而，以前的大多数研究[5]–[9]试图估计预期的行驶时间。最近关于分布估计的研究[10]–[14]通常涉及源-目的地（OD）对或密集的GPS数据，而不是稀疏的GPS轨迹。

稀疏的GPS数据通常由车辆获取，因此，从这些数据中估计行驶时间分布是一个重要的主题。然而，关于这一主题的文献非常有限。

在本文中，我们提出了从稀疏GPS数据中推断行驶时间分布的新方法。我们的目标是开发一种能够从稀疏GPS数据中能够可靠地估计行驶时间分布的方法。这将允许利用更容易获得的数据为ITS应用程序提供好处。在我们的方法中，我们推断了**道路网中行驶时间的协方差结构**。因此，该方法能够可靠地学习任何源-目的对之间的分布。为了估计协方差结构，我们将**高斯耦合**与最近开发的**贝叶斯网络推理算法**[15]结合起来，与**图形套索**[16]相比，该算法产生了更准确的网络结构和精度矩阵。这种方法的主要优点是能够处理具有不同数量观察的变量。该方法不需要更昂贵的高分辨率数据，而且非常适合稀疏、低分辨率的GPS轨迹。我们对稀疏GPS记录的大型数据集进行了广泛的数值实验，以验证所提出的方法。有趣的是，在高分辨率数据被下采样为低分辨率数据后，拟议的方法也可以应用于高分辨率数据；当可用计算资源有限时，这种方法可能是可行的。

我们考虑了新加坡一家主流出租车公司提供的数据集。它载有2010年8月期间由15 000多辆出租车组成的车队抽样的GPS位置。数据集中总共包括约1200万次行驶。每个位置（经纬度）都附有时间戳和出租车的状态。每辆车以一定的采样间隔记录数据。**由于网络规模大（数千条链路）和采样间隔大（平均60秒），我们将数据集划分为1小时的间隔。对于每个间隔，我们从该间隔中随机选择的70%路径中推断行驶时间分布，然后通过计算Kullback-Leibler发散和海林格距离以及行驶时间的经验分布来评估推断的分布其余30%的路径**。我们提出的模型利用了稀疏网络的高斯耦合和贝叶斯推理（BISN,[15]）框架，在KL发散方面优于基线方法4.9%，在海林格距离方面优于基线方法2%。我们还通过在不同长度的时间间隔的数据上训练行驶时间模型，并将这些模型与以后时间间隔的经验行驶时间分布进行比较，来研究所提出模型的性能。

论文的其余部分组织如下。在第二节中，我们总结了关于估计行驶时间和行驶时间分布问题的文献。在第三节中，我们详细介绍了我们的方法。在第四节中，我们介绍并讨论了我们对新加坡出租车数据的实验结果。在第五节中，我们提出了结论性意见和今后研究的想法。

# 2. 相关工作
行驶时间估计是文献[5]–[9]、[17]–[23]中研究得很好的主题。以前的大多数研究都涉及行驶时间的估计和预测，但没有提供这些估计的置信区间[5]–[9]。最近，行驶时间分布估计受到了更多的关注[10]–[14]。估计行驶时间和行驶时间分布的问题在很大程度上取决于数据来源。这些来源包括感应回路探测器数据、探测车辆和交通摄像头的视频流。

最常见的来源之一是安装在道路上的环路探测器和类似设备的数据。根据探测器的类型，环路探测器可以记录不同的流量参数，如流量和速度。对于此类数据，有几种常见的行驶时间估计技术。某些模型植根于交通流理论[5], [6]，而其他技术则是数据驱动的，不需要理论交通模型。时间序列分析是一个数据驱动技术系列[7]–[9]，包括SVR [7]和人工神经网络(AN)[18],[19]。**卡尔曼滤波**是另一种基于时间序列的方法，也被应用于行驶时间估计；例如，戴利[20]应用卡尔曼滤波器根据环路探测器的占用率和体积数据估计行驶时间。

探测车辆是行驶时间数据的另一个可行来源。这些车辆配备了GPS系统，可以记录位置数据和时间戳（有时还有其他信息，如速度），并具有一定的采样间隔，通常从几秒钟到一分钟以上。

GPS数据还对数据的性质提出了一些不同的挑战，包括位置数据错误，以及信号在采样间隔和探测车辆数量方面的稀疏性。由于GPS设备的普及，关于此类数据的研究越来越多[10]–[13]、[23]–[27]，旨在克服上述挑战。高斯混合[28]、耦合[12]、[13]和回归方法[23]等统计模型通常应用于GPS数据，此外，马尔可夫链[24]等图形模型，[28]和贝叶斯网络[25]。

在下文中，我们简要回顾了关于行驶时间分布估计的研究。使用探测车辆数据进行研究的一个重要考虑因素是采样间隔，即车辆报告其位置的频率。文献中的采样间隔从大约一秒[11]到仅报告来源和目的地[26]不等。在表I中，我们总结了一些更相关的研究。

Ramezani和Geroliminis[24]提出了用马尔可夫链建模行驶时间分布。对于每对连续链路，他们都会构建一个行驶时间的2D图。接下来，他们将启发式网格聚类应用于此图，以计算这些特定链接的行驶时间状态。他们应用马尔可夫链来计算过渡概率和行驶时间分布。这种方法即使对动脉链路也能产生良好的分布估计，然而，它需要高分辨率的行驶时间数据。亨特等人。[25]提议将贝叶斯网络应用于仅使用始发-目的地对作为输入数据的行驶时间估计。他们应用期望最大化（EM）算法来处理路径不确定性。该方法显示出了有希望的结果，然而，它假定链接行驶时间的独立性。作为改进，亨特等人。[11]提出了一种不同的行驶时间分布估计方法。他们开发了一种以1Hz采样的密集GPS数据的方法，可以推断车辆在特定路段的停车次数。在该研究中，使用马尔可夫模型估计了行程时间分布，该模型与高斯马尔可夫随机场耦合。所提出的模型比基线模型表现更好，然而，该方法需要高分辨率数据。

从探测车辆数据中估计行驶时间分布的另一种有希望的方法是图形模型[12]–[14], [25]。Wan和Kornhauser [13]应用图形套索和高斯耦合来估计行驶时间。它们通过一系列条件路径行驶时间分布的总和来近似路径行驶时间分布。这些分布取决于滞后向量（车辆进入路径中每个链路的时间向量）。在这个框架中，不同边缘处的行驶时间之间的依赖考虑了行驶期间的时间差。为了解决观测数量可能较低的问题，通过图形套索方法估计滞后高斯耦合参数，以获得稀疏精度矩阵。在[12]中，万介绍了用于路径行驶时间估计的高斯Coula混合模型(GCMM)。在这种方法中，针对不同的场景对行驶时间进行建模。为了计算给定路径的总行驶时间，它们集成了一组路径方案上的条件路径行驶时间分布。每个场景代表一定的交通状况，每个场景中不同链路的行驶时间之间的统计依赖性是固定的。通过图形套索再次估计每个高斯耦合的参数。然而，[12]中的数值结果相当有限，因为只考虑了三条路径，每条路径都少于15个链接。

在早期的工作[14]中，我们结合了高斯耦合和图形套索方法来推断新加坡网络部分地区的行驶时间分布。在本文中，我们使用更大的数据集进行了更深入的研究，包含更多的轨迹，跨越更大的时间段。我们还提出了一个贝叶斯框架，它超越了图形套索，能够处理大型网络中稀疏的GPS数据。稀疏GPS数据比高分辨率GPS数据更容易获得，也更常见。因此，拟议的框架可以更广泛地利用。为了解决图形套索方法[12]–[14]的缺点，我们提出了**应用一种新的稀疏网络贝叶斯推理(BISN) **[15]方法。图形套索方法没有考虑穿越不同链路的车辆数量的差异，而BISN允许我们准确地模拟一些链路比其他链路更频繁地穿越的通常情况下的行驶时间分布。同时，它具有较低的计算复杂度。我们研究了使用耦合器进行路径行驶时间建模的效果，以及估计性能如何取决于路径长度、一周中的一天和一天中的小时等各种因素。

上述先前的研究要么仅限于小型网络，要么限于时间框架[12]、[13]、[28]，需要难以获得高分辨率GPS数据[11]、[24]或两者兼而有之。此外，一些研究需要对行驶时间分布进行强有力的假设，如独立性、高斯性和其他。相比之下，我们所提出的方法能够基于稀疏数据估计大型交通网络中路径的行驶时间分布，而不假设链路行驶时间分布，同时也考虑到整个网络的可变链路覆盖。

# 3. 方法论
## 3.1 问题描述
接下来我们将概述我们的统计建模方法。我们的目标是从稀疏的GPS数据中估计交通网络中路径的行驶时间分布。我们从新加坡一家出租车公司获得了1个月（2011年8月）的出租车GPS数据。每个数据点包含地理坐标、出租车标识符、时间戳和当前状态。后者的可能值包括FREE（出租车正在寻找乘客）、ON CALL（出租车已收到预订，正在接客户的路上）、POB（车上有乘客）和不活动期。我们只对POB状态下的行驶感兴趣，因为它们通常代表真实的交通状况。在[17]中研究了这一特定数据集，其中表明可以从出租车轨迹推断交通模式，只有700个（在超过15,000个中）获得70%的网络覆盖率。从这一系列GPS轨迹中，我们希望推断出网络中任何路径的行驶时间分布，间隔为一小时。

在下文中，我们将概述我们的行驶时间分布统计建模方法。**我们将与网络中路径相关的行驶时间建模为多元高斯或耦合高斯随机变量**。路径由多个链路组成，其行驶时间是单个链路行驶时间的总和，每个链路都建模为随机变量；在多变量耦合高斯模型中，单个链路上的行驶时间不一定是高斯分布的。为了确定路径行驶时间的分布，我们需要推断每个链路的行驶时间如何取决于其他链路的行驶时间。在高斯和Coula高斯模型中，这种统计关系被协方差矩阵$$\Sigma$$及其逆（精度矩阵$$K$$）完全捕获。精度矩阵以优雅的方式编码不同变量之间的依赖关系：如果两个变量$$x_i$$和$$x_j$$是条件独立的，则精度矩阵中对应的元素$$K_{i,j}$$为零。

我们将网络建模为图$$G=(V,E)$$，其中$$V$$是一组顶点，表示网络中的节点（如交叉口）,$$E$$是一组弧，表示道路连接（手头网络中的26972）。我们将**路径**定义为连续的道路连接序列，将**轨迹**定义为出租车穿过的路径。对于每个轨迹，我们知道出租车到达路径中第一个链路的时间戳和离开最后一个链路的时间戳。图1显示了我们提出的方法的总体概述。首先，**我们通过[29]中提出的基于HMM的算法，将原始GPS坐标数据转换为与图$$G$$匹配的路径**。

接下来，根据这些投影路径以及报告的时间戳，我们计算每个单独链路的旅行时间。我们假设出租车在给定路径中的所有链路上都保持恒定的速度。然后，我们计算每个链接的旅行时间，与链接长度成比例。我们将把这种方法称为“缩放方法”（参见C节）。在处理稀疏GPS轨迹的研究中，通常考虑基于比例的方法[30], [31]。在手头的数据集中，所有道路连接都被大量不同的轨迹覆盖。*在某些情况下，在当前时间间隔内，给定路径只有一个链路子集拥塞。然而，当我们计算单个链接的旅行时间时，无论任何特定路径如何，我们都会这样做。这意味着每个拥塞链路的旅行时间将部分从仅覆盖拥塞链路的轨迹计算*。由于数据量的原因，拥塞的链路将有更长的旅行时间，反之亦然。同时，所提出的分布估计方法（即将高斯耦合与贝叶斯网络推理相结合）可以与任何其他单个链路旅行时间计算方法一起应用。例如，可以使用基于张量的方法[10]。

为了模拟这些旅行时间估计的非高斯分布，我们应用高斯耦合，将非高斯旅行时间估计转换为高斯随机变量（参见F节）。

在这个转换之后，我们计算了**部分经验协方差矩阵（PECM；参见E节）**。它作为推断运输网络不同环节旅行时间协方差结构的基线方法。接下来，我们将图形套索算法[16]（图形套索；参见G节）应用于PECM，以便对精度矩阵施加稀疏性，产生旅行时间的协方差矩阵的更准确估计。除了图形套索方法，我们还应用了图形套索的替代方案，名为“**稀疏网络的贝叶斯推理”（BISN；参见H节）**，因为它已经被证明可以从数据中更准确地估计稀疏网络[15]。因此，这种方法能够考虑到数据点的数量（旅行时间）通常在链路上变化这一事实。相比之下，在图形套索方法中，人们隐式地假设每个链接具有相同数量的数据点（旅行时间）。事实上，图形套索直接应用于PECM，并且没有提供PECM元素的置信水平；这些置信水平取决于与每对链接关联的数据点的数量。BISN的另一个重要优势是其较低的计算复杂性；BISN的计算复杂性仅随变量的数量（运输网络中的链接）二次缩放，而图形套索具有立方计算复杂性。

根据缩放法获得的转换旅行时间，我们计算了平均旅行时间及其经验协方差矩阵；我们将图形套索和BISN应用于后者，以便获得协方差矩阵的更可靠估计。因此，我们得到了由旅行时间的平均向量和协方差矩阵指定的旅行时间的多元耦合模型；后者是通过图形套索或BISN获得的，我们将在本文中评估这两种方法。路径旅行时间估计值是通过从路径中链路的联合分布中采样计算的。该方法在H节和I节中描述。为了进行评估，我们选择了网络中最常见的50个轨迹，并将获得的分布与经验分布进行比较。具体来说，我们计算了两种不同的度量，即Kullback-Leibler (KL)发散和旅行时间经验分布与从不同旅行时间模型获得的边缘分布之间的海林格距离。

在下文中，我们将解释旅行时间建模管道中的 每个步骤。

## 3.2 数据预处理
来自探测车辆的数据往往有噪音；位置信息通常只有5米到10米的精度。因此，预处理数据并将GPS点投影到道路网上是很重要的。这个过程被称为地图匹配（MM），并为此目的提出了几种方法，包括几何、拓扑、概率和基于人工智能的方法[32]。由于本文所考虑的GPS数据是稀疏的，我们应用了一种基于隐马尔可夫模型的地图匹配算法，该算法特别适合这种稀疏数据[29]。对于该算法，每个可能的路段都被表示为隐藏状态，其观测概率$$p$$（观测）取决于轨迹点和路段之间的距离$$d$$、路段宽度$$2\omega$$和GPS误差$$\delta_g$$的标准偏差：
$$p(observation)=\frac{1}{2\omega}\int^\omega_{-\omega}\frac{1}{2\pi\delta^2_g}e^{-\frac{(1-d)^2}{2\delta^2_g}}d\mathcal{l}$$
发射概率$$p(observation|r)$$定义为：
$$p(observation|r)=\frac{v_{max}}{max(0,v_{obs}-v_{max})+v_{max}}p(observation)$$
其中$$r$$是候选段，$$v_{obs}$$是观察到的速度，$$v_{max}$$是速度限制。(2)中的比率表示超速罚款系数。

Goh等人。[29]应用支持向量机计算状态之间的转换概率。它们通过改进的维特比算法确定最可能的路段序列。有关更多详细信息，我们请读者参考[29]。

## 3.3 基于标度法的链路旅行时间估计
在获得地图匹配数据后，我们计算每个链路的旅行时间。实现这一目标的最直接的方法之一是**假设出租车车辆在整个多链路路径上具有恒定的平均速度**。我们通过重新缩放路径旅行时间$$T_p$$，计算长度为$$l_i$$的链路$$i$$的旅行时间$$t_i$$，如下所示：

$$t_i=\frac{l_iT_P}{\sum_{j\in P}l_j}$$

我们在图2中提供了这种计算的说明。在计算所有轨迹（来自不同出租车）的这些估计后，我们对每个链路的平均值进行平均值，以计算平均旅行时间。

为了提高这些中间旅行时间估计的准确性，我们纳入了有关路段上轨迹点位置的信息。设第一段$$j_1 \in P$$上的映射轨迹点为$$A$$，最后一段$$j_K \in P$$上的点为$$B$$，其中$$K$$是沿路径$$P$$的GPS点总数。设$$\hat{l_1}$$是$$A$$到$$j_1$$最后一点之间的距离，$$\hat{l_K}$$是$$B$$到$$j_K$$最后一点之间的距离。我们计算旅行时间估计$$t_i$$如下：

$$t_i=\frac{l_iT_P}{\hat{l}_1+\hat{l}_K+\sum\limits^{K-1}_{j=2} l_j}$$

通过更仔细地考虑第一个和最后一个GPS点沿着第一个和最后一个链路的位置，估计(4)与（3）相比变得更准确。

## 3.4 高斯耦合
