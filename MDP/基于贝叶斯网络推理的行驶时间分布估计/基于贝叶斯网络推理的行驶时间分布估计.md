基于贝叶斯网络推理的行驶时间分布估计
---------------

# 摘要
行驶时间估计是智能交通系统（ITS）的一个重要方面。在城市环境中，由于各种随机因素，行驶时间可能会出现很大的变化。因此，我们专注于估计行驶时间分布，**与大部分研究的平均预期行驶时间估计形成鲜明对比**。我们提出了从浮动汽车数据中推断行驶时间分布的算法，特别是从稀疏的GPS测量中推断行驶时间分布。该框架结合了**高斯耦合**和**网络推理**，以估计行驶时间的**边缘和联合分布**。我们对一个月的GPS轨迹进行了一系列广泛的数值实验。我们根据50个最常见的轨迹的Kullback-Leibler (KL)发散和海林格距离对所提出的模型进行了基准测试。与基线方法相比，结合高斯Coulas和贝叶斯推理的稀疏网络方法，KL发散减少4.9%，海林格距离减少2%。

# 1. 引言
智能交通系统（ITS）旨在减少交通拥堵，降低油耗，并改善交通的其他方面。行驶时间信息在不同的ITS应用中起着至关重要的作用，如随机路由[1]、拼车[2]和交通监控[3]。更好地估计行驶时间可以提高此类系统的总体性能，为用户提供更准确的信息，包括更好的路线选择和交通选择[4]。ITS用户的另一个关键方面是行驶时间的变化，这会影响上述所有示例。然而，以前的大多数研究[5]–[9]试图估计预期的行驶时间。最近关于分布估计的研究[10]–[14]通常涉及源-目的地（OD）对或密集的GPS数据，而不是稀疏的GPS轨迹。

稀疏的GPS数据通常由车辆获取，因此，从这些数据中估计行驶时间分布是一个重要的主题。然而，关于这一主题的文献非常有限。

在本文中，我们提出了从稀疏GPS数据中推断行驶时间分布的新方法。我们的目标是开发一种能够从稀疏GPS数据中能够可靠地估计行驶时间分布的方法。这将允许利用更容易获得的数据为ITS应用程序提供好处。在我们的方法中，我们推断了**道路网中行驶时间的协方差结构**。因此，该方法能够可靠地学习任何源-目的对之间的分布。为了估计协方差结构，我们将**高斯耦合**与最近开发的**贝叶斯网络推理算法**[15]结合起来，与**图形套索**[16]相比，该算法产生了更准确的网络结构和精度矩阵。这种方法的主要优点是能够处理具有不同数量观察的变量。该方法不需要更昂贵的高分辨率数据，而且非常适合稀疏、低分辨率的GPS轨迹。我们对稀疏GPS记录的大型数据集进行了广泛的数值实验，以验证所提出的方法。有趣的是，在高分辨率数据被下采样为低分辨率数据后，拟议的方法也可以应用于高分辨率数据；当可用计算资源有限时，这种方法可能是可行的。

我们考虑了新加坡一家主流出租车公司提供的数据集。它载有2010年8月期间由15 000多辆出租车组成的车队抽样的GPS位置。数据集中总共包括约1200万次行驶。每个位置（经纬度）都附有时间戳和出租车的状态。每辆车以一定的采样间隔记录数据。**由于网络规模大（数千条链路）和采样间隔大（平均60秒），我们将数据集划分为1小时的间隔。对于每个间隔，我们从该间隔中随机选择的70%路径中推断行驶时间分布，然后通过计算Kullback-Leibler发散和海林格距离以及行驶时间的经验分布来评估推断的分布其余30%的路径**。我们提出的模型利用了稀疏网络的高斯耦合和贝叶斯推理（BISN,[15]）框架，在KL发散方面优于基线方法4.9%，在海林格距离方面优于基线方法2%。我们还通过在不同长度的时间间隔的数据上训练行驶时间模型，并将这些模型与以后时间间隔的经验行驶时间分布进行比较，来研究所提出模型的性能。

论文的其余部分组织如下。在第二节中，我们总结了关于估计行驶时间和行驶时间分布问题的文献。在第三节中，我们详细介绍了我们的方法。在第四节中，我们介绍并讨论了我们对新加坡出租车数据的实验结果。在第五节中，我们提出了结论性意见和今后研究的想法。

# 2. 相关工作
行驶时间估计是文献[5]–[9]、[17]–[23]中研究得很好的主题。以前的大多数研究都涉及行驶时间的估计和预测，但没有提供这些估计的置信区间[5]–[9]。最近，行驶时间分布估计受到了更多的关注[10]–[14]。估计行驶时间和行驶时间分布的问题在很大程度上取决于数据来源。这些来源包括感应回路探测器数据、探测车辆和交通摄像头的视频流。

最常见的来源之一是安装在道路上的环路探测器和类似设备的数据。根据探测器的类型，环路探测器可以记录不同的流量参数，如流量和速度。对于此类数据，有几种常见的行驶时间估计技术。某些模型植根于交通流理论[5], [6]，而其他技术则是数据驱动的，不需要理论交通模型。时间序列分析是一个数据驱动技术系列[7]–[9]，包括SVR [7]和人工神经网络(AN)[18],[19]。**卡尔曼滤波**是另一种基于时间序列的方法，也被应用于行驶时间估计；例如，戴利[20]应用卡尔曼滤波器根据环路探测器的占用率和体积数据估计行驶时间。

探测车辆是行驶时间数据的另一个可行来源。这些车辆配备了GPS系统，可以记录位置数据和时间戳（有时还有其他信息，如速度），并具有一定的采样间隔，通常从几秒钟到一分钟以上。

GPS数据还对数据的性质提出了一些不同的挑战，包括位置数据错误，以及信号在采样间隔和探测车辆数量方面的稀疏性。由于GPS设备的普及，关于此类数据的研究越来越多[10]–[13]、[23]–[27]，旨在克服上述挑战。高斯混合[28]、耦合[12]、[13]和回归方法[23]等统计模型通常应用于GPS数据，此外，马尔可夫链[24]等图形模型，[28]和贝叶斯网络[25]。

在下文中，我们简要回顾了关于行驶时间分布估计的研究。使用探测车辆数据进行研究的一个重要考虑因素是采样间隔，即车辆报告其位置的频率。文献中的采样间隔从大约一秒[11]到仅报告来源和目的地[26]不等。在表I中，我们总结了一些更相关的研究。

Ramezani和Geroliminis[24]提出了用马尔可夫链建模行驶时间分布。对于每对连续链路，他们都会构建一个行驶时间的2D图。接下来，他们将启发式网格聚类应用于此图，以计算这些特定链接的行驶时间状态。他们应用马尔可夫链来计算过渡概率和行驶时间分布。这种方法即使对动脉链路也能产生良好的分布估计，然而，它需要高分辨率的行驶时间数据。亨特等人。[25]提议将贝叶斯网络应用于仅使用始发-目的地对作为输入数据的行驶时间估计。他们应用期望最大化（EM）算法来处理路径不确定性。该方法显示出了有希望的结果，然而，它假定链接行驶时间的独立性。作为改进，亨特等人。[11]提出了一种不同的行驶时间分布估计方法。他们开发了一种以1Hz采样的密集GPS数据的方法，可以推断车辆在特定路段的停车次数。在该研究中，使用马尔可夫模型估计了行程时间分布，该模型与高斯马尔可夫随机场耦合。所提出的模型比基线模型表现更好，然而，该方法需要高分辨率数据。

从探测车辆数据中估计行驶时间分布的另一种有希望的方法是图形模型[12]–[14], [25]。Wan和Kornhauser [13]应用图形套索和高斯耦合来估计行驶时间。它们通过一系列条件路径行驶时间分布的总和来近似路径行驶时间分布。这些分布取决于滞后向量（车辆进入路径中每个链路的时间向量）。在这个框架中，不同边缘处的行驶时间之间的依赖考虑了行驶期间的时间差。为了解决观测数量可能较低的问题，通过图形套索方法估计滞后高斯耦合参数，以获得稀疏精度矩阵。在[12]中，万介绍了用于路径行驶时间估计的高斯Coula混合模型(GCMM)。在这种方法中，针对不同的场景对行驶时间进行建模。为了计算给定路径的总行驶时间，它们集成了一组路径方案上的条件路径行驶时间分布。每个场景代表一定的交通状况，每个场景中不同链路的行驶时间之间的统计依赖性是固定的。通过图形套索再次估计每个高斯耦合的参数。然而，[12]中的数值结果相当有限，因为只考虑了三条路径，每条路径都少于15个链接。

在早期的工作[14]中，我们结合了高斯耦合和图形套索方法来推断新加坡网络部分地区的行驶时间分布。在本文中，我们使用更大的数据集进行了更深入的研究，包含更多的轨迹，跨越更大的时间段。我们还提出了一个贝叶斯框架，它超越了图形套索，能够处理大型网络中稀疏的GPS数据。稀疏GPS数据比高分辨率GPS数据更容易获得，也更常见。因此，拟议的框架可以更广泛地利用。为了解决图形套索方法[12]–[14]的缺点，我们提出了**应用一种新的稀疏网络贝叶斯推理(BISN) **[15]方法。图形套索方法没有考虑穿越不同链路的车辆数量的差异，而BISN允许我们准确地模拟一些链路比其他链路更频繁地穿越的通常情况下的行驶时间分布。同时，它具有较低的计算复杂度。我们研究了使用耦合器进行路径行驶时间建模的效果，以及估计性能如何取决于路径长度、一周中的一天和一天中的小时等各种因素。

上述先前的研究要么仅限于小型网络，要么限于时间框架[12]、[13]、[28]，需要难以获得高分辨率GPS数据[11]、[24]或两者兼而有之。此外，一些研究需要对行驶时间分布进行强有力的假设，如独立性、高斯性和其他。相比之下，我们所提出的方法能够基于稀疏数据估计大型交通网络中路径的行驶时间分布，而不假设链路行驶时间分布，同时也考虑到整个网络的可变链路覆盖。

# 3. 方法论
## 3.1 问题描述
我们将首先描述问题陈述，接下来我们将概述我们的统计建模方法。我们的目标是从稀疏的GPS数据中估计交通网络中路径的行驶时间分布。我们从新加坡一家出租车公司获得了1个月（2011年8月）的出租车GPS数据。每个数据点包含地理坐标、出租车标识符、时间戳和当前状态。后者的可能值包括FREE（出租车正在寻找乘客）、ONCAL（出租车已收到预订，正在接客户的路上）、POB（车上有乘客）和不活动期。我们只对POB状态下的行驶感兴趣，因为它们通常代表真实的交通状况。在[17]中研究了这一特定数据集，其中表明可以从出租车轨迹推断交通模式，只有700个（在超过15,000个中）获得70%的网络覆盖率。从这一系列GPS轨迹中，我们希望推断出网络中任何路径的行驶时间分布，间隔为一小时。

在下文中，我们将概述我们的行驶时间分布统计建模方法。**我们将与网络中路径相关的行驶时间建模为多元高斯或耦合高斯随机变量**。路径由多个链路组成，其行驶时间是单个链路行驶时间的总和，每个链路都建模为随机变量；在多变量耦合高斯模型中，单个链路上的行驶时间不一定是高斯分布的。为了确定路径行驶时间的分布，我们需要推断每个链路的行驶时间如何取决于其他链路的行驶时间。在高斯和Coula高斯模型中，这种统计关系被协方差矩阵$$\Sigma$$及其逆（精度矩阵$$K$$）完全捕获。精度矩阵以优雅的方式编码不同变量之间的依赖关系：如果两个变量$$x_i$$和$$x_j$$是条件独立的，则精度矩阵中对应的元素$$K_{i,j}$$为零。

我们将网络建模为图$$G=(V,E)$$，其中$$V$$是一组顶点，表示网络中的节点（如交叉口）,$$E$$是一组弧，表示道路连接（手头网络中的26972）。我们将路径定义为连续的道路连接序列，将轨迹定义为出租车穿过的路径。对于每个轨迹，我们知道出租车到达路径中第一个链路的时间戳和离开最后一个链路的时间戳。图1显示了我们提出的方法的总体概述。首先，**我们通过[29]中提出的基于HMM的算法，将原始GPS坐标数据转换为与图G匹配的路径**。



