在具体实施中，我们选取的GPS轨迹数据坐标系为WGS84坐标系，路网数据为OpenStreetMap提供的OSM格式的路网数据。首先对以上数据进行预处理，GPS轨迹点需删除车辆未移动或移动距离很短的点，因为这种情况下GPS设备采集的数据集中在某一个区域呈现不规则形状，采样点之间的位置信息为概率性波动，这会干扰采样点间的相互影响，导致后续的计算中产生大量噪声且增加计算时长；路网数据需简化结构，合并同一十字路口的所有交叉点视为同一交叉点，降低路网中交点个数。在数据处理完成后，将路网数据与GPS轨迹数据通过转换公式转换为三维笛卡尔坐标，然后将转换后的路网数据构建三维KD树，通过KNN算法在该树中查找每个GPS轨迹点的候选路段，根据每个采样点的若干候选路段，将GPS轨迹点与其对应的若干候选路段通过web墨卡托投影计算出对应的候选点。此时得到了每个GPS轨迹点对应的若干候选点，通过位置上下文分析中时间分析、空间分析以及道路分析，计算出相邻候选点的权重，在计算过程中，舍弃不满足三个约束条件的路径，约束1保证了后续参与运算的数据都符合实际路网结构，不会出现不存在的路径；约束2保证了不会出现下述情况：如果错误的候选路径的累积权重大于前几个正确候选路径的权重，即便在后续候选中权值逐渐减小，但最终累积权重有概率大于正确路径的权重，导致生成错误的结果；约束3由于考虑了路网的三维结构，通过限速与车辆行驶速度的关系提高了匹配候选路径的准确性。以上三点约束能够在参与后续计算之前过滤掉大部分的错误路径，减少运算时间。连续的GPS采样点之间会相互影响，通过对采样点之间进行相互影响建模，得到距离权重矩阵$\Phi$，然后再创建候选图G’=\{V,E\}，每条边都拥有累积权重与投票数属性。根据生成的候选图，通过公式cw(c_i^s )=max\{cw(c_(i-1)^t )+ψ_ts^((i,j) ) \},t=1,2,…,n计算累计权重，ψ_ts^((i,j) )是c_(i-1)^t→c_i^s的权重，受p_i和p_j的距离影响，通过计算累计权重得到了每个候选点的局部最优路径。最后遍历每个候选点的局部最优路径对每条路径进行投票，票数最多的路径为最优匹配路径。
