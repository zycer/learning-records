# 地图匹配算法

## 摘要附图
本发明公开了一种地图匹配算法，解决了GPS轨迹与路网的匹配准确率与效率的问题。首先，利用路网数据构建三维KD树，将整个路网划分为多个域，再通过GPS轨迹数据在KD树中进行查找，确定若干候选点；其次，其次通过路网与GPS轨迹及其之间的关系进行位置上下文分析与相互影响建模，确定每个采样点对应的候选点的局部最优路径以及候选图；最后，通过每个候选点的局部最优路径以及候选图进行交互式边投票，计算出最终的匹配结果。

> 总体流程图

## 权利说明书
1. 一种基于交互式投票的地图匹配算法，包括以下步骤：


步骤1：候选点匹配，首先进行候选路段匹配，本发明为提高候选点匹配的准确率与效率，将原始路网数据与GPS轨迹数据进行数据预处理，降低路网数据复杂度以及过滤GPS轨迹噪声，利用简化后的路网数据构建三维KD树并利用该树进行空间域搜索，得到每个采样点的若干候选路段；其次在选出候选路段的基础上进行候选点的计算，本发明使用web墨卡托投影计算每个采样点对应的若干候选点。


步骤2：位置上下文分析，GPS采样点与候选点之间以及相邻候选点之间都存在相关性，通过空间分析、时间分析以及道路分析对所有路径进行权重计算，并提出三个约束条件，当某些路径不满足所提出的约束条件时会被过滤，不参与后续计算，只有满足约束条件的路径才会被保留，参与下一步计算。


步骤3：相互影响建模，连续的GPS采样点之间会相互影响，某一点越靠近一点，对该点的影响就越大。首先，根据筛选出的候选点创建候选图G，图中包含各个相邻采样点的候选点构成的路径，再以时间分析、空间分析以及道路分析为基础，构建静态评分矩阵M，根据矩阵M，相互影响建模为n-1为距离权重矩阵W。


步骤4：交互式投票，首先通过遍历上述步骤生成的候选图，计算所有候选点的局部最优路径，局部最优路径可以反映最终匹配路径所经过的路径的可能性。如果路径XXX（用P表示）被更多的路径所包含，则路径P称为最终路径一部分的概率就越大；如果路径P没有被任何局部最优路径所包含，则最终匹配路径不包括该路径P；再根据每个候选点的局部最优路径，对每条路径进行投票，每两个相邻采样点之间的候选点形成的路径只选出一个票数最大的，最终选出票数最大的路径作为最终路径。



