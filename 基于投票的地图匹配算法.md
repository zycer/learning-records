一种基于交互式投票的低采样率GPS数据地图匹配算法
----


# 摘要
车载设备提供的GPS数据极大地丰富了基于位置的系统应用，地图匹配在其中发挥着重要作用。对于低采样率的GPS数据，现有的地图匹配算法将面临许多挑战，如错误率高和复杂的城市道路网络效率低下。针对出租车GPS轨迹低采样率数据，提出了一种基于交互式投票的先进地图匹配算法。该算法利用空间分析函数、时间分析函数和带两个约束的道路分析函数来测量地图匹配中连续候选点之间的关系。算法中的约束不仅减少了大量的计算，而且显著提高了算法的精度。基于GPS采样点之间的相互作用，提出了一种新的投票方法，即候选边缘投票，以获得最佳的地图匹配结果。我们使用一个月的真实世界轨迹数据集评估我们的算法。该算法在精度和效率上都优于该算法。

# 1. 引言
随着GPS设备的广泛使用，手机、车辆、无人机，甚至手表都可以收集位置数据。丰富的GPS轨迹数据池正在逐步成为智能交通系统和相关服务的数据源[1], [2]。在大多数大城市，有相当多的出租车在城市中驾驶GPS设备，这导致了大量的出租车轨迹。受电磁干扰和功耗等因素的影响，与乘客一起运行的出租车的GPS数据将始终以一分钟以上的间隔记录。由于出租车可能在一分钟内行驶了相当长的距离，因此GPS位置可能并不一直在沿路段可用。实际上，大多数数据很可能具有低采样率（采样间隔大于60秒）的偏差。所有这些数据都需要后处理，例如地图匹配。地图匹配算法的目的是将GPS点与道路网中的道路段对齐【3】。

在过去的20年里，有大量的研究人员处理GPS数据上的出租车轨迹[4]–[7]和地图匹配算法[8]、[9]。在附加信息的使用方面，地图匹配算法可分为四类：几何[10]、【11】、拓扑[12]、【13】、概率【14】和其他高级技术[15]、[16]。他们中的大多数人都集中在高采样率的GPS轨迹上。低采样率GPS轨迹的地图匹配更加困难，尤其是在城市复杂的路网中。穆罕默德·Quddus等人。[17]提出了一种利用最短路径和车辆轨迹对低采样率GPS数据进行地图匹配的方法，其中车辆航向作为关键数据。然而，实际上，由于成本的原因，高精度GPS设备并不总是在出租车上。采样的车辆航向仍然不可靠。

著名的低采样率GPS数据匹配算法是郑Y等人提出的ST-Matching算法[18]和IVMM算法[19]。这些算法考虑了GPS轨迹的空间和时间信息，并对GPS点之间的加权相互影响建模。然而，算法的过程很复杂，数据必须重复映射匹配。此外，这些算法还可以在以下方面进一步改进：
- 路径上权重的简单求和将产生这样的结果：如果错误候选路径的累积权重远大于前几个候选点中的真正匹配路径，即使错误路径在其后续候选中的权重相对较小，错误路径的最终累积权重也将大于正确路径。
- 在不考虑车辆速度的实际合理范围的情况下，有时匹配轨迹的两个采样点之间的距离太长，任何车辆都无法在规定的时间内行驶。此外，所有GPS采样点都被认为是有效的，这对于GPS采样点偏移超过100米的轨迹来说是不好的。这些样本点应在数据后处理中删除。
- 地图匹配后的一些轨迹的结果将是“曲折”的，特别是在城市高架道路上（即车辆在高架道路上频繁上下行驶）。

为了解决低采样率GPS轨迹数据地图匹配中的上述问题，提出了一种基于交互式投票的高级地图匹配算法。我们的算法起源于IVMM [19]，采用空间分析函数、时间分析函数和道路分析函数，带两个约束条件来测量地图匹配中连续候选点之间的关系。

本文的其余部分如下。第二节阐述了地图匹配算法的问题，并澄清了初步的思想。所提出算法的细节见第三节。实验结果在第四节中进行了论证和分析。结论见第五节。

# 2. 问题阐述
## 2.1 地图匹配问题
首先，我们给出了与地图匹配算法相关的一些定义。
- （路段）作为道路网中的基本单元的道路段r是有向（单向或双向）边缘。每个路段都有长度r.length和速度限制r.v。每个路段都有其起点r.s和终点r.e。道路交叉口c是两个或多个路段的连接点。
- （GPS轨迹）GPS轨迹T是GPS采样点p1 → p2 → · · · → p n的序列。每个GPS点都有经度、纬度、时间戳、方向和速度的关键信息。任何连续GPS点之间的时间间隔超过60秒被定义为低采样率。
- （道路网）有向图G(V,E)，其中V是代表道路交叉口或道路段末端的一组顶点，E是代表道路段的一组边。
- （路径）路径P是路段序列r1 → r2 → · · · → r n，其中r i -1.e = r i .s, (1 ≤ i ≤ n)。r.s和r.e分别表示路段r的起点和终点。
- （局部最优路径）对于GPS轨迹T中采样点p i的每个候选点c j i，假设通过候选点c j i的最佳路径是T的真实路径。
**地图匹配**：给定GPS轨迹T和道路网G，在G中找到T的真实路径P。
## 2.2 候选点的选择
到采样点的候选点对于地图匹配至关重要。对于每个GPS点p i , i = 1, 2，。. . , n，在轨迹中，有几个候选匹配点c j i , j = 1, 2，。. . . , m。我们使用【20】中提出的KNN算法来获得候选点。即使路网复杂或GPS数据量很大，该算法仍然可以快速找到候选点。在图1中，采样点p2垂直投影在投影区域中，得到候选点c 1 2和c 2 2。如果投影区域有十字路口，则道路的交叉口也应视为候选点，即获得候选点c 3 2。将交点视为候选点是至关重要的。如果采样点p1和p3分别只有一个候选点c 1 1和c 1 3，则点p2通过垂直投影获得候选点c 1 2和c 2 2，并且不将交点c 3 2视为候选点，在地图匹配中，路径c 1 1 → c 1 2 → c 1 3和c 1 1 → c 2 2 → c 1 3都不能选择。在这种情况下，大多数车辆不会选择掉头。

## 2.3 候选点之间的相互影响
GPS采样点相互影响，尤其是相邻采样点。在图1中，我们有信心从p1到p3的最终路径经过c 3 2，而不是c 1 2或c 2 2。因为采样点p2受到p1和p3的影响。显然，越接近点，影响就越大。基于采样点和投票过程的相互影响【19】，我们提出了一种基于交互式投票的高级地图匹配算法(AIVMM)。对于采样点的每个候选点，通过第三节讨论的位置上下文分析过程，找到通过候选点的局部最优路径。

## 2.4 查找最终匹配路径
我们工作背后的一个基本假设是，局部最优路径可以反映最终匹配路径所经过的路径的可能性。如果路径c t i -1 → c s i（用P表示）没有被任何局部最优路径通过，则最终匹配路径将不包括路径P。在此假设下，找到从p i -1的候选者到p i的候选者的路径，该路径被所有局部最优路径遍历最多，并将该路径定义为最终子路径。此外，我们还提出了一个称为候选边缘投票的过程，以计算有多少局部最优路径将通过候选路径。对于每个局部最优路径，如果两个连续的候选点在路径上，则从两个候选点中的一个到另一个的路径的投票率增加1。最后，所有最终子路径都可以通过候选边缘投票过程获得。此外，将它们拼接在一起，将形成最终的匹配路径。

# 3. 基于交互式投票的高级地图匹配算法
GPS采样点具有其经度、纬度和时间戳的信息。还有车辆的即时方向和即时速度。信息的准确性由GPS设备的精度决定。信息不准确可能会导致高干扰。对于采样的GPS数据中的瞬时方向和速度不够可靠，我们不会简单地直接使用它们的值，而是从不同数据点之间的关系中提取有用的信息，如两点之间的平均速度、两点之间的权重。

提出的AIVMM算法包括四个阶段：候选点准备、位置上下文分析、相互影响建模和交互式投票。图2示出了AIVMM算法的框架。

我们使用基于KD树[20]的KNN算法的范围查询，获得第一阶段每个采样点的候选点，如第II-B节所述。然后在第二阶段，我们利用位置和道路分析和约束分析构建候选图。在第三阶段，通过加权影响建模的静态评分矩阵构建加权评分矩阵后，我们可以找到局部最优路径。根据路径，所有候选边都将在最后阶段投票为最佳匹配路径。

## 3.1 位置和道路分析
我们使用空间时间分析来测量两个连续候选点之间的影响。GPS点的测量误差满足高斯分布$$N(\mu,\sigma^2)$$ [21]，因此观测概率为：
$$N(c^j_i)=e^{-\frac{(x_i^j-\mu)^2}{2\sigma^2}}$$

其中$$c_i^j$$是采样点$$p_i$$的候选点，$$x_i^j$$是从候选$$c_i^j$$到采样点的欧几里德距离。从候选点$$c_{i-1}^t$$到候选点$$c_i^s$$的空间分析函数【18】定义为：

$$F_s(c^t_{i-1}\rightarrow c_i^s)=N(c_i^s)\times V(c_{i-1}^t\rightarrow c_i^s), 2 \leq i \leq n$$

其中$$V(c_{i-1}^t\rightarrow c_i^s)$$是过渡概率。它的目的是测量两个连续候选点之间的最短路径和直路径的相似性。它的定义为：

$$V(c_{i-1}^t\rightarrow c_i^s)=\frac{d_{i-1\rightarrow i}}{\mathcal{\omega}_{i-1,t\rightarrow(i,s)}}$$

其中$$d_{i-1\rightarrow i}$$是采样点$$p_{i-1}$$到采样点$$p_i$$的欧几里得距离，$$\mathcal{\omega}_{i-1,t \rightarrow(i,s)}$$是从候选c $$c_{i-1}^t$$到$$c^s_i$$的最短路径的长度。时间分析函数定义为：

$$F_t(c_{i-1}^t \rightarrow c_i^s)=\frac{\hat{v}(i-1,t)\rightarrow(i,s)}{|\hat{v}_{(i-1,t)\rightarrow(i,s)}-\overline{v}_{(i-1,t)\rightarrow(i,s)}|+_\hat{v}_{(i-1,t)\rightarrow(i,s)}}$$

其中$$\hat{v}_{(i-1,t)\rightarrow(i,s)}$$是从候选点$$c_{i-1}^t$$到$$c_i^s$$的最短路径的加权速度限制，$$\overline{v}_{(i-1,t)\rightarrow(i,s)}$$是沿着候选点$$c_{i-1}^t$$至$$c_i^s$$之间最短路径行驶的车辆的平均速度。在没有交通事故的情况下，车速一般接近道路限速。因此，适当的时间分析函数应在道路限速附近获得最大值。

在许多地图匹配算法中，我们经常看到在复杂的城市路网中与高架道路匹配，匹配的结果是车辆在高架道路上上下行驶。如图3所示，$$\hat{ab}$$是高架路，$$\hat{cd}$$是地面道路。$$\hat{ef}$$和$$\hat{gh}$$分别是出口匝道和入口匝道。长虚线是IVMM算法的匹配结果，我们可以看到车辆从高架路行驶下来，然后行驶到高架路上。在实际驾驶中，车辆往往沿着当前道路行驶，而不是在高架路上上下行驶。
##### 图3
在地图中，道路通常被分为几个级别，每个级别都有不同的道路限速。高架路的水平高于地面道路，即高架路的限速大于地面道路。因此，我们使用道路水平因子来模拟车辆在高限速道路上停留的趋势。$$c_{i-1}^t\rightarrow c_i^s$$的道路水平系数（RLF）定义为：

$$RLF($c_{i-1}^t\rightarrow c_i^s)=\frac{v_s}{(v_d-v_s)+v_s}$$

其中$$v_s$$和$$v_d$$表示$$c_{i-1}^t$$和$$c_i^s$$所在道路的速度限制。因此，路径$$c_{i-1}^t\rightarrow c_i^s$$的权重函数可以扩展为：

$$F(c_{i-1}^t\rightarrow c_i^s)=F_s(c_{i-1}^t\rightarrow c_i^s)\times F_t(c_{i-1}^t\rightarrow c_i^s)\times RLF(c_{i-1}^t\rightarrow c_i^s)$$

## 3.2 约束分析
根据我们对广泛实验收集的权重函数值的统计分析，错误匹配路径$$c_{i-1}^t\rightarrow c_i^s$$的权重$$F(c_{i-1}^t\rightarrow c_i^s)$$总是很低（通常小于1.0×10 -5），而且没有任何权重正确匹配路径的小于1.0×10 -5。

因此，我们将两个候选点之间的权重设置一个阈值$$\theta$$作为约束。它的定义为：

约束1：当$$F(c_{i-1}^t\rightarrow c_i^s) < \theta$$时，其中$$\theta$$是用户指定的阈值，路径$$c_{i-1}^t\rightarrow c_i^s$$被视为错误匹配。

约束1有两个优点。一个是消除第一节提到的简单权重求和的缺点。基于位置和道路分析和约束1，我们可以消除大多数错误路径。因此，即使错误候选路径的累积权重远大于前几个候选点中真正匹配的路径，我们也不会在其后续候选中选择错误路径。最大的最终累积权重将是真正匹配的路径。另一个优点是，它消除了那些权重太小的路径，减少了寻找局部最优路径的计算工作量。

仅使用时间分析功能测量车速是不够的，因为它没有考虑车辆在沿匹配路径行驶时的速度是否在合理范围内。道路限速是关键信息。从地图中，我们可以得到每条道路的限速，并计算$$c_{i-1}^t\rightarrow c_i^s$$经过的所有路径的加权平均限速$$\overline{v}_{\omega}(c_{i-1}^t\rightarrow c_i^s)$$。考虑到车辆平均速度与道路加权平均限速之间的关系，匹配路径上的车辆速度不会超过合理的范围。

约束2：$$\overline{v}(c_{i-1}^t\rightarrow c_i^s)$$是车辆沿着候选点$$c_{i-1}^t$$至$$c^s_i$$之间最短路径行驶的平均速度。$$\overline{v}_{\omega}(c_{i-1}^t\rightarrow c_i^s)$$是$$c_{i-1}^t\rightarrow c_i^s$$经过的所有路径的加权平均速度限制。当$$\overline{v}(c_{i-1}^t\rightarrow c_i^s)>\alpha \overline{v}_{\omega}(c_{i-1}^t\rightarrow c_i^s)$$时，$$1 ≤ α ≤ 2$$时，路径$$c_{i-1}^t\rightarrow c_i^s$$被视为误差匹配。

