import torch
from torch_geometric_temporal.data import StaticGraphTemporalSignal

# 随机生成边索引
edges = torch.randint(0, 5, (2, 6), dtype=torch.long)

# 转换为无向图
edge_index = torch.cat([edges, edges[[1, 0]]], dim=1).unique(dim=1)

# 随机生成4个时间戳下所有节点的特征
num_snapshots = 4
num_nodes = 5
num_features = 3  # 自定义特征数量
features_list = [torch.randn(num_nodes, num_features) for _ in range(num_snapshots)]

# 随机生成4个时间戳下的边权重
edge_weight_list = [torch.randn(edge_index.size(1)) for _ in range(num_snapshots)]

# 随机生成4个时间戳下的目标列表
targets_list = [torch.randint(0, 2, (num_nodes,)) for _ in range(num_snapshots)]

# 使用StaticGraphTemporalSignal构建时空图
static_graph = StaticGraphTemporalSignal(edge_index, edge_weight_list, features_list, targets_list)

# 输出时空图的相关信息
print("Edge index:")
print(static_graph.edge_index)
print("\nNode features:")
for i, features in enumerate(static_graph.features_list):
    print
